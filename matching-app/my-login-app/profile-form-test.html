<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”„ë¡œí•„ í¼ í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background-color: #007bff; color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #0056b3; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        .debug { background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 15px; margin-top: 20px; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>í”„ë¡œí•„ í¼ ì œì¶œ í…ŒìŠ¤íŠ¸</h1>
    <p>ì´ í˜ì´ì§€ëŠ” í¼ ì œì¶œì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.</p>
    
    <form id="test-form" onsubmit="return false;">
        <div class="form-group">
            <label for="nickname">ë‹‰ë„¤ì„</label>
            <input type="text" id="nickname" name="nickname" required value="í…ŒìŠ¤íŠ¸ìœ ì €">
        </div>
        <div class="form-group">
            <label for="gender">ì„±ë³„</label>
            <select id="gender" name="gender" required>
                <option value="">ì„ íƒí•˜ì„¸ìš”...</option>
                <option value="male">ë‚¨ì„±</option>
                <option value="female" selected>ì—¬ì„±</option>
                <option value="other">ê¸°íƒ€</option>
            </select>
        </div>
        <div class="form-group">
            <label for="birthdate">ìƒë…„ì›”ì¼</label>
            <input type="date" id="birthdate" name="birthdate" required value="1995-01-01">
        </div>
        <div class="form-group">
            <label for="bio">ìê¸°ì†Œê°œ</label>
            <textarea id="bio" name="bio" rows="3">ì•ˆë…•í•˜ì„¸ìš”! í…ŒìŠ¤íŠ¸ ì¤‘ì…ë‹ˆë‹¤.</textarea>
        </div>
        <button type="button" id="save-btn" onclick="handleFormSubmit(event)">í”„ë¡œí•„ ì €ì¥ (í…ŒìŠ¤íŠ¸)</button>
    </form>

    <div class="debug">
        <h3>ğŸ”§ ë””ë²„ê¹… ë¡œê·¸</h3>
        <div id="debug-log"></div>
        <button type="button" onclick="clearLog()">ë¡œê·¸ ì§€ìš°ê¸°</button>
    </div>

    <script>
        // ë¡œê·¸ í•¨ìˆ˜
        function log(message, type = 'info') {
            const debugLog = document.getElementById('debug-log');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : '';
            debugLog.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            debugLog.scrollTop = debugLog.scrollHeight;
            console.log(`[${timestamp}] ${message}`);
        }

        function clearLog() {
            document.getElementById('debug-log').innerHTML = '';
        }

        // í¼ ì œì¶œ í•¸ë“¤ëŸ¬
        async function handleFormSubmit(event) {
            log("=== í¼ ì œì¶œ ì‹œì‘ ===");
            log(`ì´ë²¤íŠ¸ íƒ€ì…: ${event ? event.type : 'undefined'}`);
            log(`ì´ë²¤íŠ¸ ëŒ€ìƒ: ${event ? event.target.tagName : 'undefined'}`);
            
            // ê¸°ë³¸ ë™ì‘ ë°©ì§€
            if (event) {
                event.preventDefault();
                event.stopPropagation();
                log("preventDefault() ë° stopPropagation() í˜¸ì¶œë¨");
            }

            const button = document.getElementById('save-btn');
            const originalText = button.textContent;

            try {
                // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
                button.disabled = true;
                button.textContent = 'ì²˜ë¦¬ ì¤‘...';
                button.style.backgroundColor = '#ffc107';
                log("ë²„íŠ¼ ìƒíƒœ ë³€ê²½ë¨", 'info');

                // í¼ ë°ì´í„° ìˆ˜ì§‘
                const formData = {
                    nickname: document.getElementById('nickname').value.trim(),
                    gender: document.getElementById('gender').value,
                    birthdate: document.getElementById('birthdate').value,
                    bio: document.getElementById('bio').value.trim()
                };

                log(`ìˆ˜ì§‘ëœ ë°ì´í„°: ${JSON.stringify(formData)}`, 'info');

                // ìœ íš¨ì„± ê²€ì‚¬
                if (!formData.nickname || !formData.gender || !formData.birthdate) {
                    throw new Error('í•„ìˆ˜ í•„ë“œê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤');
                }

                log("ìœ íš¨ì„± ê²€ì‚¬ í†µê³¼", 'success');

                // ê°€ì§œ ì €ì¥ í”„ë¡œì„¸ìŠ¤ (2ì´ˆ ëŒ€ê¸°)
                log("ì €ì¥ í”„ë¡œì„¸ìŠ¤ ì‹œì‘...");
                await new Promise(resolve => setTimeout(resolve, 2000));

                // ì„±ê³µ ì²˜ë¦¬
                button.textContent = 'ì €ì¥ ì™„ë£Œ!';
                button.style.backgroundColor = '#28a745';
                log("ì €ì¥ ì™„ë£Œ!", 'success');

                // 2ì´ˆ í›„ ë§¤ì¹­ í˜ì´ì§€ë¡œ ì´ë™í•œë‹¤ê³  ê°€ì •
                setTimeout(() => {
                    log("ë§¤ì¹­ í˜ì´ì§€ë¡œ ì´ë™ ì˜ˆì • (ì‹¤ì œë¡œëŠ” ì´ë™í•˜ì§€ ì•ŠìŒ)", 'success');
                    
                    // ë²„íŠ¼ ë³µì›
                    button.disabled = false;
                    button.textContent = originalText;
                    button.style.backgroundColor = '';
                }, 2000);

                return true;

            } catch (error) {
                log(`ì˜¤ë¥˜ ë°œìƒ: ${error.message}`, 'error');
                
                // ë²„íŠ¼ ë³µì›
                button.disabled = false;
                button.textContent = originalText;
                button.style.backgroundColor = '';
                
                return false;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            log("í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ");
            
            // í¼ ì œì¶œ ë°©ì§€ ì„¤ì •
            const form = document.getElementById('test-form');
            
            form.onsubmit = function(event) {
                log("í¼ onsubmit í˜¸ì¶œë¨ - ê¸°ë³¸ ë™ì‘ ë°©ì§€");
                event.preventDefault();
                event.stopPropagation();
                return false;
            };

            form.addEventListener('submit', function(event) {
                log("í¼ addEventListener submit í˜¸ì¶œë¨ - ê¸°ë³¸ ë™ì‘ ë°©ì§€");
                event.preventDefault();
                event.stopPropagation();
                return false;
            });

            log("ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ", 'success');
        });
    </script>
</body>
</html>
